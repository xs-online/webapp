(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-trends-user_trends_publish"],{2907:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",[i("v-uni-view",{staticClass:" pad"},[i("v-uni-view",{staticClass:" mt10 lr10"},[i("v-uni-view",{staticClass:"fs18 bold"},[t._v("我要发布")]),i("v-uni-textarea",{staticClass:"bz2 mt10  radius-10 ",staticStyle:{width:"100%"},attrs:{maxlength:"200",placeholder:"选择美图,讲点骚话"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),i("v-uni-view",{staticClass:"flex-space fs14"},[i("v-uni-view",{staticClass:"gray666",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.choose_movie()}}},[t._v("引用长视频")]),i("v-uni-view",[t._v(t._s(t.content.length)+"/200")])],1)],1),t.video_id>0?i("v-uni-view",{staticClass:"relative flex-space pad mt10 mb10 lr10",staticStyle:{background:"#262b4c"}},[i("v-uni-image",{staticClass:"pic-25",staticStyle:{position:"absolute",right:"-10px",top:"-10px"},attrs:{src:"/static/chat/delete1.png"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.video_info={},t.video_id=0}}}),i("v-uni-image",{staticClass:"radius-2 ",staticStyle:{height:"80px",width:"100px",margin:"0px auto"},attrs:{src:t.himg2(t.video_info.img),mode:"widthFix"}}),i("v-uni-view",{staticClass:"fs14  flex-1 ml10",staticStyle:{"word-break":"break-all"}},[t._v(t._s(t.video_info.name))])],1):t._e(),i("v-uni-view",{staticClass:"upload_area upload_area_list lr10 mt10"},[t._l(t.imgs,(function(e,n){return i("v-uni-view",{key:n,staticClass:"sc mr10",style:"background-image:url("+e+");background-repeat:no-repeat;background-size: 100%; background-position: center;"},[i("v-uni-view",{staticClass:"cc_del",staticStyle:{position:"absolute",right:"-12px",top:"-12px"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.del_img(t.imgs,n)}}},[i("v-uni-image",{staticStyle:{width:"25px",height:"25px"},attrs:{src:"/static/chat/delete1.png"}})],1)],1)})),t.video?i("v-uni-view",{staticClass:"sc mr10",style:"background-image:url(/static/chat/video_cover.png);background-repeat:no-repeat;background-size:40%; background-position: center;"},[i("v-uni-view",{staticClass:"cc_del",staticStyle:{position:"absolute",right:"-12px",top:"-12px"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.del_video.apply(void 0,arguments)}}},[i("v-uni-image",{staticStyle:{width:"25px",height:"25px"},attrs:{src:"/static/chat/delete1.png"}})],1)],1):t._e(),t.imgs.length<16?i("v-uni-view",{staticClass:"sc"},[i("v-uni-image",{staticStyle:{width:"50px",height:"40px"},attrs:{src:"/static/chat/addimg.png"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.upload_img.apply(void 0,arguments)}}})],1):t._e(),""==t.video?i("v-uni-view",{staticClass:"sc ml10"},[i("v-uni-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:"/static/chat/addvideo.png"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.upload_video.apply(void 0,arguments)}}})],1):t._e()],2)],1),i("v-uni-view",{staticClass:"flex-space item-center pad",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseLocation.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"item-center "},[i("v-uni-image",{staticClass:"pic-20 mr7",attrs:{src:"/static/chat/location.png"}}),t.address?i("v-uni-view",{staticStyle:{color:"deeppink"}},[t._v(t._s(t.address.slice(0,10)))]):i("v-uni-view",[t._v("选择位置")])],1),i("v-uni-image",{staticClass:"pic-20",attrs:{src:"/static/chat/r.png"}})],1),i("v-uni-view",{staticClass:"pad",staticStyle:{"padding-top":"20px"}},[i("v-uni-view",{staticClass:" flex-nowrap"},[i("v-uni-button",{staticClass:"but_default flex-1 flex-center ",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.add()}}},[t._v("发布")])],1)],1)],1)],1)},a=[]},"305f":function(t,e,i){"use strict";i("7a82");var n=i("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("f07e")),s=n(i("c964"));i("ac1f"),i("466d"),i("5319"),i("14d9");getApp();var o={data:function(){return{content:"",imgs:[],video:"",video_id:0,video_info:{},phone:"",userInfo:"",lat:"",lon:"",address:""}},onLoad:function(t){var e=this;if(!uni.getStorageSync("userinfo"))return this.tips("请先登录"),void setTimeout((function(){e.go("/pages/login/login")}),1e3);"undefined"!=typeof t.video_id&&(this.video_id=t.video_id,this.get_video_info()),this.userInfo=uni.getStorageSync("userinfo")},mounted:function(){},methods:{go:function(t){uni.navigateTo({url:t})},himg2:function(t){t+="";return"null"!=t.match(/\/cover/)?t.replace(".jpg","_h_small.jpg"):t},upload_img:function(){var t=this;this.chooseMoreImage((function(e){uni.hideLoading(),t.imgs.push(e),t.$forceUpdate()})),console.log(t.imgs)},upload_video:function(){var t=this;this.chooseVideo((function(e){uni.hideLoading(),t.video=e,t.$forceUpdate(),console.log("sssssssssssssssssssssssss",t.video)}))},del_img:function(t,e){var i=this;uni.showModal({title:"提示",content:"确定删除吗",success:function(n){n.confirm&&i.del_key(t,e)}})},get_video_info:function(){var t=this;return(0,s.default)((0,a.default)().mark((function e(){var i,n,s;return(0,a.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i={id:t.video_id},e.next=3,uni.$api.video.details(i);case 3:return n=e.sent,t.video_info=n,t.$refs.videoRefs.open(),e.next=8,uni.$api.user.index();case 8:s=e.sent,console.log(s,"uuuuuuuuuuuuuuuu"),uni.setStorageSync("userinfo",s),t.userInfo=s;case 12:case"end":return e.stop()}}),e)})))()},del_video:function(){var t=this;uni.showModal({title:"提示",content:"确定删除吗",success:function(e){e.confirm&&(t.video="")}})},choose_movie:function(){uni.navigateTo({url:"/pages/client/tuan/ss?from=publish"})},add:function(){var t=this;return(0,s.default)((0,a.default)().mark((function e(){var i,n;return(0,a.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t,console.log(i.content),n={content:i.content,imgs:i.imgs.join("|"),address:i.address,lat:i.lat,lon:i.lon,video:i.video,video_id:i.video_id},uni.showLoading(),e.next=6,uni.$api.userTrends.publish(n);case 6:e.sent,uni.hideLoading(),t.success("发布成功"),i.content="",i.imgs=[],i.video="",setTimeout((function(){i.go("/pages/trends/user_index?uid="+i.userInfo.id)}),2e3);case 13:case"end":return e.stop()}}),e)})))()},chooseLocation:function(){var t=this;uni.chooseLocation({success:function(e){console.log("选择的位置:",e),t.lat=e.latitude,t.lon=e.longitude,t.address=e.address},fail:function(t){console.error("位置选择失败:",t)}})}}};e.default=o},"31ab":function(t,e,i){"use strict";i.r(e);var n=i("305f"),a=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a},3797:function(t,e,i){var n=i("a4e7");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("3acea505",n,!0,{sourceMap:!1,shadowMode:!1})},"85dc":function(t,e,i){"use strict";var n=i("3797"),a=i.n(n);a.a},a4e7:function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,"uni-page-body[data-v-21220bd8]{background:#13131f;color:#cfdadc}body.?%PAGE?%[data-v-21220bd8]{background:#13131f}.upload_area[data-v-21220bd8]{display:flex;align-items:space-between;position:relative}.upload_area_list[data-v-21220bd8]{display:flex;flex-wrap:wrap}.upload_area .sc[data-v-21220bd8]{width:30%;height:100px;margin-bottom:%?20?%;position:relative;z-index:0;border-radius:%?6?%;background:#24243e;justify-content:center;display:flex;align-items:center;flex-direction:column;color:#999;line-height:120%}.upload_area .kg[data-v-21220bd8]{width:%?20?%}.upload_area .sc uni-text[data-v-21220bd8]{font-size:%?20?%}.upload_area .ico2[data-v-21220bd8]{width:%?80?%;height:%?80?%}",""]),t.exports=e},c60b:function(t,e,i){"use strict";i.r(e);var n=i("2907"),a=i("31ab");for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);i("85dc");var o=i("f0c5"),c=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"21220bd8",null,!1,n["a"],void 0);e["default"]=c.exports}}]);